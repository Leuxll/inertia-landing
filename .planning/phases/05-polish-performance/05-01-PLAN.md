---
phase: 05-polish-performance
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/geometric-accent.tsx
  - src/components/ui/feature-section.tsx
  - src/components/features/whats-next-section.tsx
  - src/lib/animations.ts
autonomous: true

must_haves:
  truths:
    - "Background circles in the hero section shift vertically at different rates as the user scrolls, creating layered depth"
    - "Phone frame mockups in feature sections have a subtle upward drift (opposite scroll direction) that feels grounded"
    - "What's Next cards visibly elevate with a box shadow lift and slight scale-up when hovered"
    - "Button component primary variant glows subtly (faint white box-shadow) on hover in addition to existing scale"
    - "Email input in CtaBlock shows a refined focus ring (border opacity transition) as a micro-interaction"
  artifacts:
    - path: "src/components/ui/geometric-accent.tsx"
      provides: "Parallax hero background via useScroll + useTransform"
      contains: "useScrollVelocity|useTransform|parallax"
    - path: "src/components/ui/feature-section.tsx"
      provides: "Parallax phone frame (subtle upward drift)"
      contains: "useScroll|useTransform"
    - path: "src/components/features/whats-next-section.tsx"
      provides: "Card hover micro-interactions"
      contains: "whileHover"
    - path: "src/lib/animations.ts"
      provides: "Parallax and micro-interaction presets"
      contains: "parallax"
  key_links:
    - from: "src/components/ui/geometric-accent.tsx"
      to: "window scroll position"
      via: "useScroll() from motion/react"
      pattern: "useScroll|useTransform"
    - from: "src/components/ui/feature-section.tsx"
      to: "window scroll position"
      via: "useScroll({ target: ref }) from motion/react"
      pattern: "useScroll|useTransform"
---

<objective>
Add parallax depth effects to hero background and feature section phone frames, plus micro-interactions on cards, buttons, and form inputs — making the page feel premium and cinematic.

Purpose: The page currently animates in on scroll but is static once visible. Parallax and micro-interactions add the layer of ambient motion that separates landing pages from apps.
Output: Updated GeometricAccent (hero parallax), FeatureSection (phone parallax), WhatsNext cards (hover lift), animations presets, and Button + input micro-interactions.
</objective>

<execution_context>
@/Users/yuefunglee/.config/Claude/get-shit-done/workflows/execute-plan.md
@/Users/yuefunglee/.config/Claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-polish-performance/05-CONTEXT.md

Relevant source files (read before editing):
@src/components/ui/geometric-accent.tsx
@src/components/ui/feature-section.tsx
@src/components/features/whats-next-section.tsx
@src/components/ui/button.tsx
@src/components/ui/cta-block.tsx
@src/lib/animations.ts
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Parallax on hero background and phone frames</name>
  <files>
    src/components/ui/geometric-accent.tsx
    src/components/ui/feature-section.tsx
    src/lib/animations.ts
  </files>
  <action>
**GeometricAccent (hero background parallax):**

The two rotating circles should drift at different vertical rates as the user scrolls the hero section, reinforcing depth.

1. Add `useScroll` and `useTransform` imports from `motion/react`.
2. Use `useScroll({ offset: ["start start", "end start"] })` at the component root (no target ref needed — this tracks the viewport scroll through the hero). Assign to `const { scrollYProgress } = useScroll(...)`.
3. Create two parallax transforms:
   - Large circle: `const y1 = useTransform(scrollYProgress, [0, 1], [0, -60])` — drifts 60px up by the time hero exits
   - Small circle: `const y2 = useTransform(scrollYProgress, [0, 1], [0, -30])` — drifts 30px up (slower = feels closer)
4. Apply `style={{ y: y1 }}` to the large circle `motion.div` and `style={{ y: y2, translate: "10% -5%" }}` to the small circle (replace the current `style={{ translate: "10% -5%" }}`).
5. Keep the existing `animate={{ rotate }}` on both — parallax AND rotation both work simultaneously.

**FeatureSection (phone frame parallax):**

The phone frame should drift subtly upward as the user scrolls past each feature section, creating a floating device effect.

1. Add a `useRef` to the Section wrapper: `const sectionRef = useRef<HTMLDivElement>(null)`.
2. Use `useScroll({ target: sectionRef, offset: ["start end", "end start"] })` to get scroll progress relative to the section in view.
3. Create: `const phoneY = useTransform(scrollYProgress, [0, 1], [20, -20])` — moves 20px up total as section scrolls through viewport.
4. Wrap the existing `motion.div` that contains `<PhoneFrame>` with `style={{ y: phoneY }}`. Keep `variants={fadeUp}` for the scroll-in animation — both work.
5. The component is already `"use client"` — just add the new hooks at the top.

**animations.ts additions:**

Add these exports for reuse (even if not referenced yet — establishes the pattern):
```ts
// Micro-interaction hover for elevated cards
export const cardHover = {
  rest: { y: 0, boxShadow: "0 0 0 0 rgba(244,244,240,0)" },
  hover: {
    y: -4,
    boxShadow: "0 12px 40px rgba(244,244,240,0.06)",
    transition: { duration: 0.3, ease: [0.25, 0.1, 0.25, 1.0] }
  },
};
```

**Important:** Use ONLY `transform` and `opacity` for parallax (already compositor-only). Do NOT use `top/left/margin` — that causes layout thrash. `y` in Framer Motion uses `translateY` which is compositor-only.
  </action>
  <verify>
    1. `npm run build` passes with no TypeScript errors
    2. `npm run dev` then scroll the hero — background circles drift vertically at different rates
    3. Scroll through a feature section — phone frame has subtle upward float
  </verify>
  <done>
    Hero background has two parallax layers moving at different rates. Each feature section phone frame drifts upward on scroll. No layout shifts or jank. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Micro-interactions on cards, buttons, and inputs</name>
  <files>
    src/components/features/whats-next-section.tsx
    src/components/ui/button.tsx
    src/components/ui/cta-block.tsx
  </files>
  <action>
**WhatsNext feature cards (hover lift):**

The three upcoming feature cards should elevate on hover with a lift + subtle glow. The cards are `motion.div` elements inside `whats-next-section.tsx`.

1. Add `initial="rest"` and `whileHover="hover"` (NOT `whileHover={{ ... }}` inline — use variant names for cleaner code).
2. Import `cardHover` from `@/lib/animations`.
3. Apply `variants={cardHover}` to each card `motion.div`.
4. The existing `variants={fadeUp}` on each card conflicts — remove it from individual cards (the parent `motion.div` with `staggerContainer` handles the scroll-in stagger). The children inherit from parent variants when using `whileInView` at parent level. Switch the card's `motion.div` back to the fade-up approach: keep `variants={fadeUp}` for the scroll-in BUT add a separate wrapper:
   - Outer `motion.div` handles scroll-in with `variants={fadeUp}` (existing)
   - Inner `motion.div` handles hover with `initial="rest" whileHover="hover" variants={cardHover}` wrapping the card content

   Simplest implementation: wrap the card content `div` (the one with `bg-surface rounded-2xl p-6...`) in a new `motion.div` with `initial="rest" whileHover="hover" variants={cardHover}` and move the bg/border/padding classes to that inner div.

**Button component (primary glow on hover):**

The white CTA button should emit a subtle white glow on hover — reinforcing its call-to-action weight.

1. In `button.tsx`, update `whileHover` for the primary variant to add a `boxShadow` alongside the existing scale:
   - For `primary` variant: `whileHover={{ scale: 1.02, boxShadow: "0 0 20px rgba(255,255,255,0.15)" }}`
   - For `secondary` variant: keep existing `whileHover={{ scale: 1.02, opacity: 0.9 }}`
2. To apply variant-specific hover props, check the `variant` prop and conditionally set `whileHover`. Use a variable:
   ```tsx
   const hoverAnimation = variant === 'primary'
     ? { scale: 1.02, boxShadow: "0 0 20px rgba(255,255,255,0.15)" }
     : { scale: 1.02, opacity: 0.9 };
   ```
   Then: `whileHover={hoverAnimation}`.
3. Keep `whileTap={{ scale: 0.98 }}` unchanged.

**Email input focus micro-interaction:**

The email input in `cta-block.tsx` already has `transition-colors` and `focus:border-text/30` via Tailwind. Enhance it:

1. Keep the existing Tailwind classes but add `focus:ring-1 focus:ring-text/20` to create a faint glow ring on focus.
2. Also add `transition-all duration-300` to make the border/ring transition smooth.
3. This is a pure Tailwind change — no Framer Motion needed for the input itself.

**Do NOT add hover animations to the nav or footer** — those are minimal by design.
  </action>
  <verify>
    1. `npm run build` passes with no TypeScript errors
    2. `npm run dev`:
       - Hover over each What's Next card — it lifts with shadow
       - Hover over primary CTA button — subtle white glow appears
       - Click into email input — faint ring appears with smooth transition
  </verify>
  <done>
    What's Next cards lift +4px with shadow on hover. Primary button glows on hover. Email input has refined focus ring. All transitions feel intentional and on-brand. Build passes.
  </done>
</task>

</tasks>

<verification>
After both tasks:
1. `npm run build` — no errors
2. `npm run dev`:
   - Hero background circles drift at different parallax rates on scroll
   - Feature section phone frames float upward subtly as you scroll past them
   - What's Next cards elevate on hover
   - CTA button glows on hover
   - Email input has smooth focus ring
3. Visual check: parallax motion is subtle — not dramatic. It should feel like depth, not distraction.
</verification>

<success_criteria>
- VIS-04 satisfied: parallax depth on hero background and device mockups
- VIS-05 satisfied: micro-interactions on cards (lift), buttons (glow), inputs (focus ring)
- No Lighthouse regressions from JavaScript additions (all compositor-only transforms)
- TypeScript build passes clean
</success_criteria>

<output>
After completion, create `.planning/phases/05-polish-performance/05-01-SUMMARY.md` following the summary template.
</output>
