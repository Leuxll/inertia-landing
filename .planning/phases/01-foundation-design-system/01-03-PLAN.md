---
phase: 01-foundation-design-system
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - src/components/ui/button.tsx
  - src/components/ui/section.tsx
  - src/components/ui/container.tsx
  - src/components/ui/heading.tsx
  - src/components/ui/text.tsx
  - src/components/ui/divider.tsx
  - src/components/ui/cta-block.tsx
  - src/app/page.tsx
autonomous: true

must_haves:
  truths:
    - "Button component renders with solid white bg, dark text, sharp corners, and cinematic hover transition"
    - "Section component wraps content in a full-height responsive section with correct padding"
    - "Heading component renders Playfair Display at responsive sizes (4xl mobile, 7xl+ desktop)"
    - "Text component renders Inter with correct color tokens for default and muted variants"
    - "CtaBlock shows email-capture placeholder in waitlist mode and App Store link in download mode"
    - "All text on the page meets WCAG AA contrast ratio (4.5:1 minimum)"
    - "Page renders correctly at 375px, 768px, and 1440px viewports"
  artifacts:
    - path: "src/components/ui/button.tsx"
      provides: "Primary CTA button with cinematic hover states"
      contains: "use client"
    - path: "src/components/ui/section.tsx"
      provides: "Full-height section wrapper with responsive padding"
    - path: "src/components/ui/container.tsx"
      provides: "Max-width centered container"
    - path: "src/components/ui/heading.tsx"
      provides: "Playfair Display heading with responsive size variants"
    - path: "src/components/ui/text.tsx"
      provides: "Inter body text with color variants"
    - path: "src/components/ui/divider.tsx"
      provides: "Horizontal divider using border color token"
    - path: "src/components/ui/cta-block.tsx"
      provides: "Two-state CTA component reading from config"
      contains: "ctaMode"
  key_links:
    - from: "src/components/ui/cta-block.tsx"
      to: "src/lib/config.ts"
      via: "Imports ctaMode to switch between waitlist and download UI"
      pattern: "import.*config"
    - from: "src/components/ui/button.tsx"
      to: "src/lib/animations.ts"
      via: "Uses cinematic transition for hover/tap states"
      pattern: "cinematicTransition|motion"
    - from: "src/app/page.tsx"
      to: "src/components/ui/*"
      via: "Composes all component primitives into demo page"
      pattern: "import.*@/components/ui"
---

<objective>
Build the component primitive toolkit (Button, Section, Container, Heading, Text, Divider, CtaBlock) and validate the complete design system with a contrast audit and responsive verification. These are the building blocks Phase 2 will use to build real sections.

Purpose: Phase 2 needs to compose hero, nav, and footer sections from ready-made primitives. Building them now means Phase 2 focuses on content and conversion logic, not component design.
Output: Seven reusable components + an updated demo page proving the complete design system works at all breakpoints with WCAG-compliant contrast.
</objective>

<execution_context>
@/Users/yuefunglee/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/yuefunglee/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-design-system/01-CONTEXT.md
@.planning/phases/01-foundation-design-system/01-01-SUMMARY.md
@.planning/phases/01-foundation-design-system/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build component primitives (Button, Section, Container, Heading, Text, Divider)</name>
  <files>
    src/components/ui/button.tsx
    src/components/ui/section.tsx
    src/components/ui/container.tsx
    src/components/ui/heading.tsx
    src/components/ui/text.tsx
    src/components/ui/divider.tsx
  </files>
  <action>
    Build six component primitives following the design decisions from CONTEXT.md. All components should accept `className` for composability via Tailwind.

    1. **button.tsx** — Primary CTA button (Client Component):
       - `"use client"` — uses Motion for hover/tap animations
       - Props: `children`, `href?` (renders `<a>` if provided, `<button>` otherwise), `variant?` ("primary" | "secondary"), `className?`, standard button HTML attributes
       - Primary variant (default): solid white background (`bg-cta`), dark text (`text-cta-text`), NO border-radius (sharp corners per CONTEXT), generous padding (px-8 py-4), uppercase tracking-wide text
       - Secondary variant: transparent background, white border (`border border-text/20`), white text, sharp corners, same padding
       - Hover animation: Use `motion.button` (or `motion.a`) with `whileHover` — subtle scale (1.02) and brightness/opacity shift. Transition uses `cinematicTransition` from animations.ts (700ms ease-out).
       - `whileTap`: scale(0.98) for click feedback
       - Font: Inter (body font), bold weight, tracking-wide
       - NO border-radius anywhere — 0px sharp corners

    2. **section.tsx** — Full-height section wrapper (Server Component):
       - Props: `children`, `className?`, `id?`, `fullHeight?` (default true)
       - When `fullHeight`: `min-h-dvh` (NOT min-h-screen — per research, use dvh for iOS Safari)
       - Default padding: `py-24 px-6 md:px-8 lg:px-12` — generous vertical, responsive horizontal
       - Flex column layout, items-center to center content
       - Renders a `<section>` element with the `id` prop for scroll targeting

    3. **container.tsx** — Max-width centered container (Server Component):
       - Props: `children`, `className?`, `size?` ("default" | "narrow" | "wide")
       - Default: `max-w-5xl mx-auto w-full` (1024px — good for editorial single-column)
       - Narrow: `max-w-3xl` (768px — for text-heavy sections)
       - Wide: `max-w-7xl` (1280px — for feature grids)
       - No padding (Section handles padding)

    4. **heading.tsx** — Typography heading (Server Component):
       - Props: `children`, `as?` ("h1" | "h2" | "h3" | "h4"), `className?`, `accent?` (boolean — for italic accent phrases)
       - Renders the appropriate HTML heading element via `as` prop (default "h2")
       - Font: `font-display` (Playfair Display)
       - Color: `text-text` (#f4f4f0)
       - Size scale (responsive):
         - h1: `text-4xl md:text-6xl lg:text-8xl` (dramatic, editorial — 36px to 96px)
         - h2: `text-3xl md:text-5xl lg:text-6xl`
         - h3: `text-2xl md:text-3xl lg:text-4xl`
         - h4: `text-xl md:text-2xl`
       - When `accent`: add `italic` class (for pull quotes and key phrases)
       - Tracking: `tracking-tight` for large headings (h1, h2), normal for h3/h4
       - Leading: `leading-tight` (1.1-1.2 line height for display text)

    5. **text.tsx** — Body text (Server Component):
       - Props: `children`, `variant?` ("default" | "muted" | "small"), `className?`, `as?` ("p" | "span" | "div")
       - Renders the appropriate HTML element via `as` prop (default "p")
       - Font: `font-body` (Inter)
       - Default variant: `text-text` (#f4f4f0), `text-base md:text-lg`, `leading-relaxed`
       - Muted variant: `text-text-muted` (#a1a1a1), same sizing
       - Small variant: `text-text-muted`, `text-sm`, `leading-relaxed`
       - CRITICAL contrast note: Do NOT create any variant with text color lighter than the muted (#a1a1a1) token. The contrast boundary for WCAG AA on #0a0a0a is approximately #737373 (4.5:1). The muted token (#a1a1a1) gives 7.5:1 which is well above AA.

    6. **divider.tsx** — Section divider (Server Component):
       - Props: `className?`
       - Renders an `<hr>` element
       - Styled: `border-border` (rgba(244,244,240,0.1)), `w-full`, subtle — barely visible as a section separator
       - Optional `max-w` constraint for centered shorter dividers

    All components:
    - Accept and merge `className` for composability (use template literals or a cn() helper if needed — if creating cn(), put it in `src/lib/utils.ts` using clsx + tailwind-merge, installing both: `pnpm add clsx tailwind-merge`)
    - Export as named exports
    - Use TypeScript with explicit prop interfaces
    - Keep each component focused and small (< 50 lines)
  </action>
  <verify>
    - All six component files exist in src/components/ui/
    - Each component has TypeScript props interface
    - `pnpm build` succeeds with no type errors
    - Button uses motion for hover/tap with cinematicTransition
    - Section uses min-h-dvh (not min-h-screen)
    - Heading uses font-display (Playfair Display)
    - Text uses font-body (Inter) with contrast-safe color tokens only
    - No border-radius on any component (sharp corners everywhere)
  </verify>
  <done>Six component primitives built with correct design tokens, responsive sizing, cinematic animations, and WCAG-safe contrast</done>
</task>

<task type="auto">
  <name>Task 2: Build CtaBlock component and assemble final design system demo page</name>
  <files>
    src/components/ui/cta-block.tsx
    src/app/page.tsx
  </files>
  <action>
    1. **cta-block.tsx** — Two-state CTA component:
       - Import `ctaMode`, `isWaitlistMode` from `@/lib/config`
       - Import `Button` from `@/components/ui/button`

       **Waitlist mode:**
       - Render a placeholder form layout: a text input (email-shaped, disabled with placeholder "you@example.com") + a Button labeled "Get Early Access"
       - The input is a VISUAL PLACEHOLDER only — no form submission logic. Phase 2 will wire this up with Resend.
       - Style the input: dark surface background (`bg-surface`), white text, border-border, sharp corners, matching height with the button. Use `font-body`.
       - Layout: flex row on desktop (input + button side by side), flex column on mobile

       **Download mode:**
       - Render a Button with `href="https://apps.apple.com"` (placeholder URL) labeled "Download on App Store"
       - Optionally include a small Apple logo SVG or just text

       **Both modes:**
       - Below the CTA, show a small muted Text indicating the active mode: "Currently in {ctaMode} mode" — this is a development indicator that will be removed in Phase 2
       - Component is a Server Component (config.ts reads env at build time, no client APIs needed)

    2. **page.tsx** — Final design system demo page:
       Rebuild page.tsx using ALL the component primitives to demonstrate the complete design system. This serves as both a visual verification tool and a template for Phase 2.

       Structure:
       ```
       <Section fullHeight>
         <Container>
           <ScrollReveal>
             <Heading as="h1">Momentum</Heading>
             <Text>The Anti-Subscription Habit Tracker</Text>
             <CtaBlock />
           </ScrollReveal>
         </Container>
       </Section>

       <Divider />

       <Section>
         <Container size="narrow">
           <ScrollReveal>
             <Heading as="h2">It Hurts. It Helps.</Heading>
             <Text variant="muted">
               [A paragraph of placeholder text demonstrating muted body text.
                Use actual Momentum brand voice — philosophical, existential tone.
                Something like: "Every habit you track is a mirror. Some reflections
                are uncomfortable. That's the point."]
             </Text>
           </ScrollReveal>
         </Container>
       </Section>

       <Divider />

       <Section>
         <Container>
           <ScrollReveal variant="stagger">
             <Heading as="h3">Design System</Heading>
             [Show a grid of the two Button variants (primary + secondary)
              side by side. Show Heading sizes h1-h4 stacked. Show Text variants.
              This is a component showcase section.]
           </ScrollReveal>
         </Container>
       </Section>
       ```

       Requirements:
       - Page MUST be a Server Component (no "use client") — it composes client components (Button, ScrollReveal)
       - All sections demonstrate responsive behavior (check at 375px, 768px, 1440px)
       - All text uses only contrast-safe tokens (text-text or text-text-muted, never anything lighter)
       - The component showcase section proves all primitives render correctly
       - Include enough vertical content to demonstrate Lenis smooth scroll and scroll-reveal animations

    3. **Contrast audit** — Verify all text on the page meets WCAG AA:
       After building the page, manually check in browser DevTools:
       - #f4f4f0 text on #0a0a0a bg = 17.4:1 ratio (passes AAA)
       - #a1a1a1 text on #0a0a0a bg = 7.5:1 ratio (passes AA)
       - #ffffff text on #0a0a0a bg = 19.3:1 ratio (passes AAA)
       - #0a0a0a text on #ffffff bg = 19.3:1 ratio (passes AAA — for button text)
       - No text uses colors below #737373 on dark backgrounds

       If ANY component uses a color that fails AA, fix it before marking done.

    4. **Responsive spot check** — Verify layout at key breakpoints:
       Using browser DevTools responsive mode:
       - 375px (mobile): Content stacks vertically, headline is text-4xl, CTA input/button stack
       - 768px (tablet): Comfortable spacing, headline scales up
       - 1440px (desktop): Full editorial layout, headline is text-8xl, CTA input/button side by side
       - Sections use min-h-dvh correctly (full viewport height)
  </action>
  <verify>
    - `pnpm build` succeeds
    - `pnpm dev` shows complete design system demo page
    - CtaBlock shows "Get Early Access" with email input in waitlist mode
    - Changing NEXT_PUBLIC_CTA_MODE=download shows "Download on App Store"
    - All components render with correct fonts, colors, and sharp corners
    - Button hover animation is cinematic (700ms, smooth)
    - Page scrolls smoothly on desktop with Lenis
    - Scroll-reveal animations trigger on viewport entry
    - Layout works at 375px, 768px, and 1440px
    - No text color fails WCAG AA contrast on dark backgrounds
  </verify>
  <done>All seven component primitives built and demonstrated on a design system page. CtaBlock switches state via env var. All text passes WCAG AA contrast. Layout is responsive at all breakpoints.</done>
</task>

</tasks>

<verification>
Complete Phase 1 verification checklist:

1. **INFRA-01**: Project is built with Next.js App Router — `pnpm build` succeeds
2. **VIS-01**: Dark theme renders (#0a0a0a bg, #f4f4f0 text, #1A1A1A surfaces) — visual check
3. **VIS-02**: Playfair Display on headlines, Inter on body — DevTools font-family check
4. **NAV-03**: Lenis smooth scroll on desktop, native on touch — scroll test
5. **HERO-04**: NEXT_PUBLIC_CTA_MODE env var switches CTA state — test both values
6. **RESP-01**: Responsive at 375px, 768px, 1440px with dvh — DevTools responsive mode
7. **RESP-03**: All text meets WCAG AA (4.5:1 minimum) — contrast ratio check

Phase success criteria from roadmap:
- [ ] Dark page with Playfair/Inter fonts, no FOUT
- [ ] Smooth cinematic scroll on desktop, native on touch
- [ ] Correct rendering at mobile/tablet/desktop with 100dvh
- [ ] CTA_MODE env var changes visible element
- [ ] All text meets WCAG AA contrast
</verification>

<success_criteria>
- Seven component primitives (Button, Section, Container, Heading, Text, Divider, CtaBlock) built and working
- CtaBlock switches between waitlist and download modes via env var
- All components use correct design tokens (colors, fonts, sharp corners, cinematic transitions)
- Design system demo page showcases all components
- WCAG AA contrast verified for all text colors
- Responsive layout verified at 375px, 768px, 1440px
- Complete Phase 1 requirements (INFRA-01, VIS-01, VIS-02, NAV-03, HERO-04, RESP-01, RESP-03) met
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-design-system/01-03-SUMMARY.md`
</output>
